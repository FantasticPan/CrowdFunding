webpackJsonp([16],{"7uDM":function(t,e){},ZqWU:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={data:function(){return{message:[{id:0,date:"2016-05-03",sendMan:"王小虎",type:"动态",itemId:"11",content:'评论了你的动态"好好好好好好的首付好好好好好好的首付好好好好好好的首付好好好好好好的首付款的设计费水电费发"',isRead:1},{id:1,date:"2016-05-02",sendMan:"系统",type:"动态",itemId:"11",content:"恭喜您，抽中超值大礼包",isRead:1},{id:2,date:"2016-05-04",sendMan:"王小虎",type:"通知",itemId:"",content:"上海市普陀区金沙江路 1518 弄",isRead:0},{id:3,date:"2016-05-01",sendMan:"王小虎",type:"通知",itemId:"",content:"上海市普陀区金沙江路 1518 弄",isRead:0}],msgDialog:!1,curMsg:{},multipleSelection:[],page:0,pageTotal:20,notReadNews:2}},methods:{toggleSelection:function(t){var e=this;t?t.forEach(function(t){e.$refs.multipleTable.toggleRowSelection(t)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(t){this.multipleSelection=t},watchMsg:function(t){this.curMsg=this.message.filter(function(e,a){return e.id==t})[0],this.msgDialog=!this.msgDialog},markRead:function(t){var e=this,a=this.message.map(function(e,a){if(e.id==t)return a});this.$axios.post("/markRead",{name:this.$store.state.user.name,newsId:t}).then(function(t){t.data?(e.message[a].isRead=0,e.notReadNews--):e.$message.warning("操作失败")}).catch(function(t){return console.log(t)})},deleteNews:function(t){var e=this;this.$axios.post("/deleteNews",{name:this.$store.state.user.name,newsId:t}).then(function(t){e.message=t.data.message,e.pageTotal=t.data.pageTotal}).catch(function(t){return console.log(t)})},allMarkRead:function(){var t=this;if(this.multipleSelection.length>0){var e=[];this.multipleSelection.map(function(t,a){1==t.isRead&&e.push(t.id)}),0===e.length?this.$message.warning("已标为已读"):this.$axios.post("/markRead",{name:this.$store.state.user.name,newsIdArr:e}).then(function(e){t.message=e.data.message,t.notReadNews=e.data.notReadNews}).catch(function(t){return console.log(t)})}},allDeleteNews:function(){var t=this;if(this.multipleSelection.length>0){var e=[];this.multipleSelection.map(function(t,a){return e.push(t.id)}),this.$axios.post("/deleteNews",{name:this.$store.state.user.name,newsIdArr:e}).then(function(e){t.message=e.data.message,t.pageTotal=e.data.pageTotal}).catch(function(t){return console.log(t)})}},rowsStyle:function(t){t.row,t.column;var e=t.rowIndex;t.columnIndex;return this.message[e].isRead?"color:#000":""},goToPage:function(t){0==this.page&&-1==t?this.$message.warning("已经是第一页了"):this.page==this.pageTotal&&1==t?this.$message.warning("已经是最后一页了"):(this.page=this.page+t,init())},init:function(){var t=this;this.$axios.post("/goToPage",{name:this.$store.state.user.name,page:this.page}).then(function(e){t.message=e.data.message,t.pageTotal=e.data.pageTotal}).catch(function(t){return console.log(t)})}},mounted:function(){this.init()}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"news"},[a("h2",[t._v("最新消息 "),a("span",[t._v("(共"+t._s(t.pageTotal)+"条消息")]),a("span",[t._v(t._s(t.notReadNews)+"未读)")])]),t._v(" "),a("div",[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"cell-style":t.rowsStyle,data:t.message,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{label:"日期",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.date))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"sendMan",label:"姓名",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"content",label:"主要内容","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"编辑",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"btnGroup"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-view",circle:""},on:{click:function(a){t.watchMsg(e.row.id)}}}),t._v(" "),e.row.isRead?a("el-button",{attrs:{type:"warning",icon:"el-icon-star-off",circle:""},on:{click:function(a){t.markRead(e.row.id)}}}):t._e(),t._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){t.deleteNews(e.row.id)}}})],1)]}}])})],1),t._v(" "),a("el-row",{staticClass:"btnBox"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.allMarkRead}},[t._v("标为已读")]),t._v(" "),a("el-button",{attrs:{type:"danger",plain:""},on:{click:t.allDeleteNews}},[t._v("批量删除")]),t._v(" "),a("el-button-group",[a("el-button",{attrs:{type:"button",icon:"el-icon-arrow-left"},on:{click:function(e){t.goToPage(-1)}}},[t._v("上一页")]),t._v(" "),a("el-button",{attrs:{type:"button"},on:{click:function(e){t.goToPage(1)}}},[t._v("下一页"),a("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"消息",visible:t.msgDialog,width:"30%"},on:{"update:visible":function(e){t.msgDialog=e}}},[a("div",[a("span",[a("i",{staticClass:"fa fa-paper-plane"}),t._v(" 发件人："+t._s(t.curMsg.sendMan))]),t._v(" "),a("p",[t._v("内容：")]),t._v(" "),(t.curMsg.type,a("div",{staticClass:"newsCont"},[a("a",{attrs:{href:"javascript:;"}},[t._v(" "+t._s(t.curMsg.content)+" ")])]))]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.watchMsg(t.curMsg.id)}}},[t._v("确 定")])],1)])],1)])},staticRenderFns:[]};var i=a("VU/8")(n,s,!1,function(t){a("7uDM")},"data-v-19f9220d",null);e.default=i.exports}});
//# sourceMappingURL=16.b957c95310dfc71d97dc.js.map